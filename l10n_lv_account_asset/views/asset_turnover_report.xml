<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

<template id="asset_turnover_report_document">
    <t>
        <t t-if="o and 'company_id' in o">
            <t t-set="company" t-value="o.company_id"></t>
        </t>
        <t t-if="not o or not 'company_id' in o">
            <t t-set="company" t-value="res_company"></t>
        </t>
        <div class="page">
            <style type="text/css">
                div.title {
                    font-size: 18px;
                    display: inline;
                    text-align: center;
                    vertical-align: middle;
                    position: fixed;
                    left: 35%;
                    margin-top: 20px; 
                    margin-bottom: 20px;
                }
                table.list_table thead {
                    border: 1px solid black;
                }
                table.list_table th {
                    font-weight: normal;
                }
                table.list_table td, th {
                    padding-top: 2px;
                    padding-bottom: 2px;
                    padding-left: 4px;
                    padding-right: 4px;
                }
            </style>
            <t t-set="title" t-value="(company.partner_id.title and (company.partner_id.title.shortcut and company.partner_id.title.shortcut.upper()) or company.partner_id.title.name) or ''"></t>
            <div width="100%">
                <div style="float: left; text-align: left; display: inline; vertical-align: middle; margin-top: 20px; margin-bottom: 20px;">
                    <span t-esc="company.name"/>
                    <span t-esc="title"/>
                </div>
	            <div class="title">Asset Turnover</div>
                <div style="float: right; text-align: right; display: inline; vertical-align: middle; margin-top: 20px; margin-bottom: 20px;">
	                <span t-if="data">
                        <span>from</span>
                        <span t-esc="formatLang(data['form']['from_date'], date=True)"/>
                    </span>
	                <span t-if="data">
                        <span>to</span>
                        <span t-esc="formatLang(data['form']['to_date'], date=True)"/>
                    </span>
                </div>
            </div>
	        <br/>
	        <br/>
	        <br/>
	        <br/>
	        <table class="list_table" width="100%">
		        <thead>
			        <tr>
                        <th></th>
				        <th colspan="2">Transaction</th>
				        <th>Book value</th>
				        <th>Depreciation</th>
				        <th>Residual value</th>
			        </tr>
		        </thead>
                <t t-set="purchase_total_amount_1" t-value="0.0"></t>
                <t t-set="purchase_total_amount_2" t-value="0.0"></t>
                <t t-set="purchase_total_amount_3" t-value="0.0"></t>
                <t t-set="depr_total_amount_1" t-value="0.0"></t>
                <t t-set="depr_total_amount_2" t-value="0.0"></t>
                <t t-set="depr_total_amount_3" t-value="0.0"></t>
                <t t-set="left_total_amount_1" t-value="0.0"></t>
                <t t-set="left_total_amount_2" t-value="0.0"></t>
                <t t-set="left_total_amount_3" t-value="0.0"></t>
                <t t-set="count" t-value="0"></t>
                <t t-set="form" t-value="data and data['form'] or {}"></t>
                <t t-set="asset_list" t-value="lines(form)"></t>
		        <tbody>
                    <t t-foreach="asset_list" t-as="asset">
                        <t t-set="count" t-value="count + 1"></t>
			            <tr>
				            <td style="border-top:none; font-weight: bold; padding-top: 4px !important; padding-bottom: 4px !important;">
                                <span t-esc="asset['account_code']"/>
                            </td>
				            <td style="border-top:none; font-weight: bold; text-align: center; padding-top: 4px !important; padding-bottom: 4px !important;">
                                <span t-esc="asset['account_name']"/>
                            </td>
			            </tr>
			            <tr>
				            <td></td>
				            <td colspan="2">
                                <span>Opening balances</span>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['purchase1'])"/>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['depr1'])"/>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['left1'])"/>
                            </td>
			            </tr>
			            <tr>
				            <td></td>
				            <td colspan="2">
                                <span>Purchase</span>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['purchase2'])"/>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['depr2'])"/>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['left2'])"/>
                            </td>
			            </tr>
			            <tr>
				            <td></td>
				            <td colspan="2">
                                <span>Asset depreciation</span>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['purchase3'])"/>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['depr3'])"/>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['left3'])"/>
                            </td>
			            </tr>
			            <tr>
				            <td></td>
				            <td colspan="2">
                                <span>Liquidation</span>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['purchase4'])"/>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['depr4'])"/>
                            </td>
				            <td style="text-align:right">
                                <span t-esc="formatLang(asset['left4'])"/>
                            </td>
			            </tr>
			            <tr>
				            <td>
                                <span>Total:</span>
                            </td>
				            <td>
                                <span t-esc="asset['account_code']"/>
                            </td>
				            <td>
                                <span>Total change:</span>
                            </td>
				            <td style="text-align:right; border-top: 1px solid black;">
                                <span t-esc="formatLang(asset['purchase_total1'])"/>
                            </td>
				            <td style="text-align:right; border-top: 1px solid black;">
                                <span t-esc="formatLang(asset['depr_total1'])"/>
                            </td>
				            <td style="text-align:right; border-top: 1px solid black;">
                                <span t-esc="formatLang(asset['left_total1'])"/>
                            </td>
			            </tr>
			            <tr style="border-bottom: 1px solid black;">
				            <td style="border-style:none" colspan="2"></td>
				            <td style="border-style:none">
                                <span>End of period:</span>
                            </td>
				            <td style="border-style:none;text-align:right">
                                <span t-esc="formatLang(asset['purchase_total2'])"/>
                            </td>
				            <td style="border-style:none;text-align:right">
                                <span t-esc="formatLang(asset['depr_total2'])"/>
                            </td>
				            <td style="border-style:none;text-align:right">
                                <span t-esc="formatLang(asset['left_total2'])"/>
                            </td>
			            </tr>
                        <t t-set="purchase_total_amount_1" t-value="purchase_total_amount_1 + asset['purchase1']"></t>
                        <t t-set="depr_total_amount_1" t-value="depr_total_amount_1 + asset['depr1']"></t>
                        <t t-set="left_total_amount_1" t-value="left_total_amount_1 + asset['left1']"></t>
                        <t t-set="purchase_total_amount_2" t-value="purchase_total_amount_2 + asset['purchase_total1']"></t>
                        <t t-set="depr_total_amount_2" t-value="depr_total_amount_2 + asset['depr_total1']"></t>
                        <t t-set="left_total_amount_2" t-value="left_total_amount_2 + asset['left_total1']"></t>
                        <t t-set="purchase_total_amount_3" t-value="purchase_total_amount_3 + asset['purchase_total2']"></t>
                        <t t-set="depr_total_amount_3" t-value="depr_total_amount_3 + asset['depr_total2']"></t>
                        <t t-set="left_total_amount_3" t-value="left_total_amount_3 + asset['left_total2']"></t>
                        <t t-if="count == len(asset_list)">
			                <tr>
				                <td style="border-top:1px solid"></td>
				                <td style="border-top:1px solid; text-align:right; font-weight: bold; padding-right: 20px !important;">
                                    <span>Total for the report:</span>
                                </td>
				                <td style="border-top:1px solid; font-weight: bold;">
                                    <span>Beginning of period:</span>
                                </td>
				                <td style="border-top:1px solid; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(purchase_total_amount_1)"/>
                                </td>
				                <td style="border-top:1px solid; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(depr_total_amount_1)"/>
                                </td>
				                <td style="border-top:1px solid; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(left_total_amount_1)"/>
                                </td>
			                </tr>
			                <tr>
				                <td colspan="2" style="border-style:none"></td>
				                <td style="border-style:none; font-weight: bold;">
                                    <span>Change:</span>
                                </td>
				                <td style="border-style:none; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(purchase_total_amount_2)"/>
                                </td>
				                <td style="border-style:none; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(depr_total_amount_2)"/>
                                </td>
				                <td style="border-style:none; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(left_total_amount_2)"/>
                                </td>
			                </tr>
			                <tr>
				                <td colspan="2" style="border-style:none"></td>
				                <td style="border-style:none; font-weight: bold;">
                                    <span>End of period:</span>
                                </td>
				                <td style="border-style:none; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(purchase_total_amount_3)"/>
                                </td>
				                <td style="border-style:none; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(depr_total_amount_3)"/>
                                </td>
				                <td style="border-style:none; text-align:right; font-weight: bold;">
                                    <span t-esc="formatLang(left_total_amount_3)"/>
                                </td>
			                </tr>
                        </t>
                    </t>
		        </tbody>
	        </table>
        </div>
    </t>
</template>

<template id="asset_turnover_report">
    <t t-call="report.html_container">
        <t t-foreach="doc_ids" t-as="doc_id">
            <t t-raw="translate_doc(doc_id, doc_model, 'company_id.partner_id.lang', 'l10n_lv_account_asset.asset_turnover_report_document')"/>
        </t>
    </t>
</template>

</data>
</openerp>